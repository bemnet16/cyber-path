# Exploiting API Authorization
Exploiting API authorization vulnerabilities involves finding weaknesses in how an API manages and enforces access controls. Attackers leverage various techniques to bypass authentication and authorization mechanisms, gaining unauthorized access to resources or performing unauthorized actions.

## Broken Object Level Authorization #BOLA

It is a security vulnerability that occurs when an application or system improperly manages access controls for objects or resources. Essentially, it means that an attacker can manipulate the system to gain unauthorized access to resources by exploiting flaws in how permissions are enforced at the object level. This can lead to serious security breaches, as attackers can access sensitive data or perform actions they shouldn't be able to. BOLA vulnerabilities are significant concerns in web applications, APIs, and other software systems

When hunting for BOLA there are three ingredients needed for successful exploitation.
1. *Resource ID*: a resource identifier will be the value used to specify a unique resource. This could be as simple as a number, but will often be more complicated.
2. *Requests that access resources:* In order to test if you can access another user's resource, you will need to know the requests that are necessary to obtain resources that your account should not be authorized to access.
3. *Missing or flawed access controls:* In order to exploit this weakness, the API provider must not have access controls in place. This may seem obvious, but just because resource IDs are predictable, does not mean there is an authorization vulnerability present.
#### Finding Resource IDs and Requests
To test for authorization weaknesses in an API, you can analyze how resources are structured and attempt to access resources you shouldn't be able to access. By detecting patterns in API paths and parameters, you might predict other potential resources. 
For example, if you notice resource IDs in API requests, such as `/api/resource/1` or `/user/account/find?user_id=15`, you can try altering these values to access unauthorized resources, like `/api/resource/3` or `/user/account/find?user_id=23`. If you can successfully access unauthorized information, you've discovered an authorization vulnerability.

Here are some ideas for requests that could be good targets for an authorization test:
1. Check the documentation and make requests to the API to understand how resources are identified.
2. Look for patterns in resource IDs and parameters within API requests.
3. Attempt to access resources by altering resource IDs or parameters in requests, following patterns observed in the API.
4. If successful, you may have discovered an authorization vulnerability that needs to be addressed.

requests that could be good targets for an authorization test. 
 ![](https://kajabi-storefronts-production.kajabi-cdn.com/kajabi-storefronts-production/site/2147573912/products/expdzRMeT7oYzCVtiZAC_Authz3.PNG)

##### Searching for BOLA
First, let's think about the purpose of our target app and review the documentation. Thinking through the purpose of the app will give you a conceptual overview and help aim your sights. Ask questions like: What can you do with this app? Do you get your own profile? Can you upload files? Do you have an account balance? Is there any part of the app that has data specific to your account? Questions like these will help you search through the available requests and find a starting point for discovering requests that access resources.

#### Authorization Testing Strategy

When searching for authorization vulnerabilities the most effective way to find authorization weaknesses is to create two accounts and perform A-B testing. The A-B testing process consists of:

1. Create a UserA account.
2. Use the API and discover requests that involve resource IDs as UserA.
3. Document requests that include resource IDs and should require authorization.
4. Create a UserB account.
5. Obtaining a valid UserB token and attempt to access UserA's resources.


## Broken Function Level Authorization #BFLA

Where BOLA is all about accessing resources that do not belong to you, BFLA is all about performing unauthorized actions. BFLA vulnerabilities are common for requests that perform actions of other users. These requests could be lateral actions or escalated actions. Lateral actions are requests that perform actions of users that are the same role or privilege level. Escalated actions are requests that perform actions that are of an escalated role like an administrator. The main difference between hunting for BFLA is that you are looking for functional requests. This means that you will be testing for various HTTP methods, seeking out actions of other users that you should not be able to perform.

For BFLA we will be hunting for very similar requests to BOLA

Notice that the hunt for BFLA looks familiar, the main difference is that we will be seeking out functional requests. When we are thinking of CRUD (create, read, update, and delete), BFLA will mainly concern requests that are used to update, delete, and create resources that we should not be authorized to. For APIs that means that we should scrutinize requests that utilize POST, PUT, DELETE, and potentially GET with parameters.