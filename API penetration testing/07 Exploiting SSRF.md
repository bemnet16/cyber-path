# Server-Side Request Forgery (SSRF)
Server-Side Request Forgery (SSRF) is a vulnerability that allows attackers to manipulate the server into making requests to other resources on behalf of the server itself. This can be leveraged by attackers to access internal systems, pivot into further attacks, or perform actions such as data exfiltration.

#### SSRF Impact
The impact of this vulnerability is that an attacker would be able to leverage the target server to perform and process requests that they supply. The attacker could supply URLs that expose private data, scan the target's internal network, or compromise the target through remote code execution.

### Types of SSRF
In terms of exposed response there are three types of SSRF vulnerabilities, *non blind*, *semi-blind* and *Blind(Out of Band) SSRF*. 

**Not blind SSRF**, means that the server responds with the resources specified by the end user. If the attacker specifies the payload as [http://google.com](http://google.com/) to a server with an In-Band SSRF vulnerability the server would make the request and respond to the attacker with information served from google.com. 

**Blind SSRF** takes place when the attacker supplies a URL and the server makes the request but does not send information from the specified URL back to the attacker. In the case of Blind SSRF, you would need a web server that will capture the request from the target to prove that you forced the server to make the request.

In this case, the response is returned and we do not have any indication that the server is vulnerable. we will need to provide the URL to a web server that will let us see if a request is actually made. To stick with free tools, we can use one of these free sites: 
- [http://webhook.site](http://webhook.site/)
- [http://pingb.in/](http://pingb.in/) 
- [https://requestbin.com/](https://requestbin.com/) 
- [https://canarytokens.org/](https://canarytokens.org/)

### Ingredients for SSRF

When targeting an API for SSRF vulnerabilities, you will want to look for requests that have any of the following:  

- Include full URLs in the POST body or parameters
- Include URL paths (or partial URLs) in the POST body or parameters
- Headers that include URLs like Referer
- Allows for user input that may result in a server retrieving resources


## Mitigation mechanisms
Mitigating SSRF vulnerabilities requires a multi-layered approach. some of them are:

1. **Input Validation and Whitelisting**: Validate and sanitize user-supplied URLs to ensure they point to allowed resources and protocols. Whitelist acceptable domains and protocols to restrict the scope of acceptable URLs.
    
2. **Use of Allowlists**: Instead of blacklist-based approaches, where you specify what not to allow, use allowlists to explicitly specify what is allowed. This reduces the risk of attackers bypassing restrictions by using variations or obscure protocols.
    
3. **Network Segmentation**: Segment your network to restrict access to sensitive internal resources from the application server. This limits the potential impact of SSRF attacks by preventing attackers from directly accessing critical systems.
    
4. **Firewall Rules**: Implement firewall rules to restrict outgoing traffic from the application server, blocking requests to internal IP addresses or sensitive external services.
    
5. **Least Privilege**: Ensure that the application server has the least privileges necessary to perform its functions. Restrict access to sensitive APIs and internal resources based on the principle of least privilege.
    
6. **Security Headers**: Utilize security headers such as Content Security Policy (CSP) to restrict the domains from which resources can be loaded, helping to prevent SSRF attacks.
    
7. **Regular Security Audits**: Conduct regular security audits and penetration tests to identify and remediate SSRF vulnerabilities before they can be exploited by attackers.